
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Qemu搭建ARM-vexpress开发环境-2-u-boot启动kernel · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="Qemu搭建ARM-vexpress开发环境-3-NFS网络根文件系统.html" />
    
    
    <link rel="prev" href="Qemu搭建ARM-vexpress开发环境-1.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" >
            
                <span>
            
                    
                    计算机基础
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../elf/">
            
                <a href="../elf/">
            
                    
                    ELF
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1.1" data-path="../elf/linux中ELF二进制程序解析.html">
            
                <a href="../elf/linux中ELF二进制程序解析.html">
            
                    
                    Linux中ELF二进制程序解析
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.2" data-path="../elf/linux中ELF二进制程序解析----ELF文件实例解析.html">
            
                <a href="../elf/linux中ELF二进制程序解析----ELF文件实例解析.html">
            
                    
                    Linux中ELF二进制程序解析----ELF文件实例解析
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../driver/">
            
                <a href="../driver/">
            
                    
                    Linux driver
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" >
            
                <span>
            
                    
                    BringUp
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1.1" data-path="../bringup/u-boot引导kernel启动过程.html">
            
                <a href="../bringup/u-boot引导kernel启动过程.html">
            
                    
                    u-boot引导kernel启动过程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.2" data-path="../bringup/Linux内核启动流程-基于ARM64.html">
            
                <a href="../bringup/Linux内核启动流程-基于ARM64.html">
            
                    
                    Linux内核启动流程-基于ARM64
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.2" >
            
                <span>
            
                    
                    Driver
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.1" data-path="../driver/Linux字符设备驱动.html">
            
                <a href="../driver/Linux字符设备驱动.html">
            
                    
                    Linux字符设备驱动
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.2" data-path="../driver/Linux块设备驱动.html">
            
                <a href="../driver/Linux块设备驱动.html">
            
                    
                    Linux块设备驱动
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../platform/">
            
                <a href="../platform/">
            
                    
                    platform
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.3.1" data-path="../platform/platform总线设备驱动模型.html">
            
                <a href="../platform/platform总线设备驱动模型.html">
            
                    
                    platform总线设备驱动模型
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="../tty/">
            
                <a href="../tty/">
            
                    
                    tty
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="../i2c/">
            
                <a href="../i2c/">
            
                    
                    i2c
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../tool/">
            
                <a href="../tool/">
            
                    
                    Tool
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" >
            
                <span>
            
                    
                    qemu
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1.1" data-path="Qemu搭建ARM-vexpress开发环境-1.html">
            
                <a href="Qemu搭建ARM-vexpress开发环境-1.html">
            
                    
                    Qemu搭建ARM-vexpress开发环境-1
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.4.1.2" data-path="Qemu搭建ARM-vexpress开发环境-2-u-boot启动kernel.html">
            
                <a href="Qemu搭建ARM-vexpress开发环境-2-u-boot启动kernel.html">
            
                    
                    Qemu搭建ARM-vexpress开发环境-2-u-boot启动kernel
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.3" data-path="Qemu搭建ARM-vexpress开发环境-3-NFS网络根文件系统.html">
            
                <a href="Qemu搭建ARM-vexpress开发环境-3-NFS网络根文件系统.html">
            
                    
                    Qemu搭建ARM-vexpress开发环境-3-NFS网络根文件系统
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../hexo/">
            
                <a href="../hexo/">
            
                    
                    hexo
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.2.1" data-path="../hexo/Hexo-Github搭建个人博客.html">
            
                <a href="../hexo/Hexo-Github搭建个人博客.html">
            
                    
                    Hexo-Github搭建个人博客
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.2" data-path="../hexo/Ubuntu-Hexo-Github搭建个人博客.html">
            
                <a href="../hexo/Ubuntu-Hexo-Github搭建个人博客.html">
            
                    
                    Ubuntu-Hexo-Github搭建个人博客
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Qemu搭建ARM-vexpress开发环境-2-u-boot启动kernel</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="qemu&#x642D;&#x5EFA;arm-vexpress&#x5F00;&#x53D1;&#x73AF;&#x5883;2----u-boot&#x542F;&#x52A8;kernel">Qemu&#x642D;&#x5EFA;ARM vexpress&#x5F00;&#x53D1;&#x73AF;&#x5883;(2)----u-boot&#x542F;&#x52A8;kernel</h1>
<h2 id="&#x76EE;&#x5F55;">&#x76EE;&#x5F55;</h2>
<p>[TOC]</p>
<p>&#x5728;&#x4E0A;&#x6587;&#x300A;<a href="https://www.jianshu.com/p/94833e841742" target="_blank">Qemu&#x642D;&#x5EFA;ARM vexpress&#x5F00;&#x53D1;&#x73AF;&#x5883;(1)</a>&#x300B;&#x4E2D;&#x5DF2;&#x7ECF;&#x7B80;&#x5355;&#x8BB2;&#x8FF0;&#x4E86;&#x901A;&#x8FC7;Qemu&#x76F4;&#x63A5;&#x542F;&#x52A8;Linux&#x5185;&#x6838;&#xFF0C;&#x5E76;&#x6302;&#x8F7D;SD&#x5361;&#x6839;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x8FD9;&#x79CD;&#x65B9;&#x6CD5;&#x662F;&#x76F4;&#x63A5;&#x542F;&#x52A8;&#x5185;&#x6838;&#xFF0C;&#x4E0E;&#x5B9E;&#x9645;&#x5E94;&#x7528;&#x4E2D;ARM&#x677F;&#x7684;&#x542F;&#x52A8;&#x65B9;&#x5F0F;&#xFF1A;u-boot&#x3001;kernel&#x3001;rootfs&#x6709;&#x4E9B;&#x4E0D;&#x540C;&#x3002;&#x73B0;&#x5728;&#x5C31;&#x6765;&#x8BB2;&#x8FF0;&#x4E0B;&#x7528;Qemu&#x642D;&#x5EFA;&#x901A;&#x8FC7;u-boot&#x542F;&#x52A8;Linux&#x5185;&#x6838;&#x5E76;&#x6302;&#x8F7D;&#x6839;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x7684;&#x65B9;&#x6CD5;&#x3002;</p>
<!--more-->
<h2 id="1-&#x7B80;&#x8FF0;">1. &#x7B80;&#x8FF0;</h2>
<p>&#x5D4C;&#x5165;&#x5F0F;&#x7CFB;&#x7EDF;&#x8981;&#x6B63;&#x5E38;&#x8FD0;&#x884C;&#xFF0C;&#x5E94;&#x8BE5;&#x5305;&#x542B;&#xFF1A;u-boot&#x3001;kernel&#x3001;rootfs&#x3001;appfs&#x3002;&#x8FD9;&#x51E0;&#x90E8;&#x5206;&#x5728;ARM&#x5F00;&#x53D1;&#x677F;Flash&#x4E0A;&#x7684;&#x4F4D;&#x7F6E;&#x5173;&#x7CFB;&#x5E94;&#x8BE5;&#x7C7B;&#x4F3C;&#x4E8E;&#x4E0B;&#x56FE;&#x6240;&#x793A;&#xFF1A;</p>
<table>
<thead>
<tr>
<th style="text-align:center">BootLoader</th>
<th style="text-align:center">BootParameters</th>
<th style="text-align:center">Kernel</th>
<th style="text-align:center">Rootfs</th>
<th style="text-align:center">Appfs</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<p>&#x5D4C;&#x5165;&#x5F0F;&#x7CFB;&#x7EDF;&#x7684;&#x542F;&#x52A8;&#x6D41;&#x7A0B;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code class="lang-mermaid">graph TB
    BootLoader(BootLoader)--BootParameters--&gt;Kernel(Kernel)--&gt;Rootfs(Rootfs)--&gt;Appfs(Appfs)
</code></pre>
<p>rootfs&#x53EF;&#x4EE5;&#x6DFB;&#x52A0;&#x5230;&#x5F00;&#x53D1;&#x677F;&#x7684;Flash&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x4E0D;&#x7528;&#x6DFB;&#x52A0;&#x5230;&#x5F00;&#x53D1;&#x677F;&#xFF0C;&#x800C;&#x662F;&#x90E8;&#x7F72;&#x5230;PC&#x673A;&#x4E0A;&#xFF0C;&#x5F00;&#x53D1;&#x677F;&#x5728;&#x8FD0;&#x884C;&#x5B8C;kernel&#xFF0C;&#x8981;&#x6302;&#x8F7D;rootfs&#x65F6;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;NFS&#x7F51;&#x7EDC;&#x6302;&#x8F7D;&#x5230;&#x8BBE;&#x5B9A;&#x597D;&#x7684;PC&#x673A;&#x4E0A;&#x7684;rootfs&#x6839;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x4E0A;&#xFF08;&#x4E0B;&#x4E00;&#x7BC7;&#x6587;&#x7AE0;&#x300A;Qemu&#x642D;&#x5EFA;ARM vexpress&#x5F00;&#x53D1;&#x73AF;&#x5883;(&#x4E09;)----NFS&#x7F51;&#x7EDC;&#x6839;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x300B;&#x4F1A;&#x8BE6;&#x7EC6;&#x8BB2;&#x89E3;NFS&#x7F51;&#x7EDC;&#x6302;&#x8F7D;&#x6839;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x7684;&#x5177;&#x4F53;&#x64CD;&#x4F5C;&#x65B9;&#x6CD5;&#xFF09;&#x3002;</p>
<h2 id="2-&#x51C6;&#x5907;u-boot">2. &#x51C6;&#x5907;u-boot</h2>
<p>&#x7528;&#x6765;&#x4F7F;&#x7528;u-boot&#x542F;&#x52A8;&#x52A0;&#x8F7D;Linux&#x5185;&#x6838;</p>
<h3 id="21-&#x4E0B;&#x8F7D;u-boot">2.1 &#x4E0B;&#x8F7D;u-boot</h3>
<p>&#x4ECE; <a href="http://ftp.denx.de/pub/u-boot" target="_blank">http://ftp.denx.de/pub/u-boot</a> &#x7F51;&#x7AD9;&#x9009;&#x62E9;&#x4E00;&#x4E2A;u-boot&#x7248;&#x672C;&#x6E90;&#x7801;&#x4E0B;&#x8F7D;&#xFF0C;&#x672C;&#x6587;&#x4E2D;&#x4F7F;&#x7528;&#x7684;&#x662F;u-boot-2020.01&#x7248;&#x672C;&#x3002;</p>
<h3 id="22-&#x89E3;&#x538B;u-boot">2.2 &#x89E3;&#x538B;u-boot</h3>
<p>&#x89E3;&#x538B;u-boot:</p>
<pre><code class="lang-shell"># tar -xvf u-boot-2020.01.tar.bz2
</code></pre>
<h3 id="23-&#x7F16;&#x8BD1;u-boot">2.3 &#x7F16;&#x8BD1;u-boot</h3>
<h4 id="231-&#x914D;&#x7F6E;&#x65F6;&#x78B0;&#x5230;&#x7684;&#x95EE;&#x9898;">2.3.1 &#x914D;&#x7F6E;&#x65F6;&#x78B0;&#x5230;&#x7684;&#x95EE;&#x9898;</h4>
<h5 id="&#x914D;&#x7F6E;&#x547D;&#x4EE4;">&#x914D;&#x7F6E;&#x547D;&#x4EE4;</h5>
<pre><code class="lang-shell"># make ARCH=arm CROSS_COMPILE=arm-linux-gnueabi- vexpress_ca9x4_defconfig
</code></pre>
<p>&#x5982;&#x679C;&#x6CA1;&#x6709;&#x4FEE;&#x6539;Makefile&#x548C;config.mk&#x6587;&#x4EF6;&#xFF0C;&#x9700;&#x8981;&#x5728;&#x7F16;&#x8BD1;&#x65F6;&#x52A0;&#x4E0A;ARCH&#x548C;CROSS_COMPILE&#x7684;&#x914D;&#x7F6E;&#xFF1B;&#x5728;&#x7F16;&#x8BD1;u-boot&#x65F6;&#x53EF;&#x80FD;&#x4F1A;&#x51FA;&#x73B0;&#x4E00;&#x4E9B;&#x95EE;&#x9898;&#xFF0C;&#x53EA;&#x8981;&#x9010;&#x4E2A;&#x95EE;&#x9898;&#x89E3;&#x51B3;&#x5C31;&#x53EF;&#x4EE5;&#x7F16;&#x8BD1;&#x5B8C;&#x6210;&#x4E86;&#xFF1B;</p>
<pre><code class="lang-shell">/bin/sh: 1: bison: not found
scripts/Makefile.lib:226: recipe for target &apos;scripts/kconfig/zconf.tab.c&apos; failed
make[1]: *** [scripts/kconfig/zconf.tab.c] Error 127
Makefile:539: recipe for target &apos;vexpress_ca9x4_defconfig&apos; failed
make: *** [vexpress_ca9x4_defconfig] Error 2
</code></pre>
<pre><code class="lang-shell"># sudo apt-get install bison
</code></pre>
<pre><code class="lang-shell">/bin/sh: 1: flex: not found
scripts/Makefile.lib:218: recipe for target &apos;scripts/kconfig/zconf.lex.c&apos; failed
make[1]: *** [scripts/kconfig/zconf.lex.c] Error 127
Makefile:539: recipe for target &apos;vexpress_ca9x4_defconfig&apos; failed
make: *** [vexpress_ca9x4_defconfig] Error 2
</code></pre>
<pre><code class="lang-shell"># sudo apt-get install flex
</code></pre>
<pre><code class="lang-shell"># make vexpress_ca9x4_defconfig ARCH=arm CROSS_COMPILE=arm-linux-gnueabi- O=./object
# make ARCH=arm CROSS_COMPILE=arm-linux-gnueabi- O=./object -j4
scripts/kconfig/conf  --syncconfig Kconfig
  CHK     include/config.h
  GEN     include/autoconf.mk.dep
  CFG     u-boot.cfg
  GEN     include/autoconf.mk
*** Your GCC is older than 6.0 and is not supported
arch/arm/config.mk:66: recipe for target &apos;checkgcc6&apos; failed
make: *** [checkgcc6] Error 1
</code></pre>
<pre><code class="lang-shell"># vim arch/arm/config.mk
ifeq ($(CONFIG_$(SPL_)SYS_THUMB_BUILD),y)
#archprepare: checkthumb checkgcc6
archprepare: checkthumb
checkthumb:
        @if test &quot;$(call cc-name)&quot; = &quot;gcc&quot; -a \
                        &quot;$(call cc-version)&quot; -lt &quot;0404&quot;; then \
                echo -n &apos;*** Your GCC does not produce working &apos;; \
                echo &apos;binaries in THUMB mode.&apos;; \
                echo &apos;*** Your board is configured for THUMB mode.&apos;; \
                false; \
        fi
#else
#archprepare: checkgcc6
endif

#checkgcc6:
#        @if test &quot;$(call cc-name)&quot; = &quot;gcc&quot; -a \
#                        &quot;$(call cc-version)&quot; -lt &quot;0600&quot;; then \
#                echo &apos;*** Your GCC is older than 6.0 and is not supported&apos;; \
#                false; \
#        fi
</code></pre>
<h4 id="232-&#x751F;&#x6210;&#x914D;&#x7F6E;&#x6587;&#x4EF6;">2.3.2 &#x751F;&#x6210;&#x914D;&#x7F6E;&#x6587;&#x4EF6;</h4>
<pre><code class="lang-shell"># make vexpress_ca9x4_defconfig ARCH=arm CROSS_COMPILE=arm-linux-gnueabi- O=./object
make[1]: Entering directory &apos;/home/xiami/tool/u-boot-2020.01/object&apos;
  HOSTCC  scripts/basic/fixdep
  GEN     ./Makefile
  HOSTCC  scripts/kconfig/conf.o
  YACC    scripts/kconfig/zconf.tab.c
  LEX     scripts/kconfig/zconf.lex.c
  HOSTCC  scripts/kconfig/zconf.tab.o
  HOSTLD  scripts/kconfig/conf
#
# configuration written to .config
#
make[1]: Leaving directory &apos;/home/xiami/tool/u-boot-2020.01/object&apos;
</code></pre>
<p>./configs/vexpress_ca9x4_defconfig</p>
<pre><code class="lang-shell"># ls object/.config -l
-rw-r--r-- 1 xiami xiami 22698 Mar 17 23:20 object/.config
</code></pre>
<p>&#x5982;&#x679C;&#x9700;&#x8981;&#x4FEE;&#x6539;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x4E2D;&#x7684;&#x4E00;&#x4E9B;&#x9009;&#x9879;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4EE5;&#x4E0B;&#x754C;&#x9762;&#x64CD;&#x4F5C;&#x9009;&#x62E9;&#xFF1A;</p>
<pre><code class="lang-shell"># make menuconfig ARCH=arm CROSS_COMPILE=arm-linux-gnueabi- O=./object
</code></pre>
<h4 id="233-&#x7F16;&#x8BD1;">2.3.3 &#x7F16;&#x8BD1;</h4>
<pre><code class="lang-shell"># make ARCH=arm CROSS_COMPILE=arm-linux-gnueabi- -j4 O=./object
</code></pre>
<h4 id="234-&#x7B80;&#x5316;&#x7F16;&#x8BD1;&#x8FC7;&#x7A0B;">2.3.4 &#x7B80;&#x5316;&#x7F16;&#x8BD1;&#x8FC7;&#x7A0B;</h4>
<p>&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x7F16;&#x8BD1;&#x6BD4;&#x8F83;&#x76F4;&#x63A5;&#xFF0C;&#x4F46;&#x662F;&#x5728;&#x8C03;&#x8BD5;&#x65F6;&#xFF0C;&#x9700;&#x8981;&#x591A;&#x6B21;&#x7F16;&#x8BD1;u-boot&#xFF0C;&#x53C2;&#x6570;&#x592A;&#x591A;&#x4F1A;&#x5E26;&#x6765;&#x4E0D;&#x4FBF;&#xFF0C;&#x4E8E;&#x662F;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4EE5;&#x4E0B;&#x65B9;&#x6CD5;&#xFF0C;&#x4FEE;&#x6539;Makefile&#x548C;config.mk&#x6587;&#x4EF6;&#x4E2D;&#x7684;ARCH&#x548C;CROSS_COMPILE&#x9009;&#x9879;&#xFF0C;&#x5728;&#x7F16;&#x8BD1;&#x7684;&#x65F6;&#x5019;&#x5C31;&#x53EF;&#x4EE5;&#x7701;&#x53BB;&#x4E86;&#x5728;&#x7F16;&#x8BD1;&#x547D;&#x4EE4;&#x4E2D;&#x6DFB;&#x52A0;&#x7F16;&#x8BD1;&#x914D;&#x7F6E;&#x7684;&#x8BBE;&#x7F6E;&#x3002;</p>
<p>&#x4FEE;&#x6539;Makefile</p>
<pre><code class="lang-shell"># vim Makefile
CROSS_COMPILE = arm-linux-gnueabi-
</code></pre>
<p>&#x4FEE;&#x6539;config.mk</p>
<pre><code class="lang-shell"># vim config.mk
ARCH = arm
</code></pre>
<p>&#x7F16;&#x8BD1;u-boot:</p>
<pre><code class="lang-shell"># make vexpress_ca9x4_defconfig
# make -j4
</code></pre>
<h3 id="24-&#x542F;&#x52A8;u-boot">2.4 &#x542F;&#x52A8;u-boot</h3>
<p>&#x901A;&#x8FC7;Qemu&#x542F;&#x52A8;&#x547D;&#x4EE4;&#x542F;&#x52A8;u-boot&#xFF1A;</p>
<pre><code class="lang-shell"># qemu-system-arm -M vexpress-a9 -m 512M -nographic -kernel ./u-boot

U-Boot 2020.01 (Mar 17 2020 - 23:21:36 +0800)

DRAM:  512 MiB
WARNING: Caches not enabled
Flash: 128 MiB
MMC:   MMC: 0
*** Warning - bad CRC, using default environment

In:    serial
Out:   serial
Err:   serial
Net:   smc911x-0
Hit any key to stop autoboot:  0 
=&gt;
</code></pre>
<p>&#x67E5;&#x770B;u-boot&#x7684;&#x7248;&#x672C;&#xFF1A;</p>
<pre><code class="lang-shell">=&gt; version
U-Boot 2020.01 (Mar 20 2020 - 23:01:23 +0800)

arm-linux-gnueabi-gcc (Ubuntu/Linaro 7.5.0-3ubuntu1~18.04) 7.5.0
GNU ld (GNU Binutils for Ubuntu) 2.30
</code></pre>
<p>&#x6253;&#x5370;u-boot&#x7684;&#x73AF;&#x5883;&#x53D8;&#x91CF;&#xFF1A;</p>
<pre><code class="lang-shell">=&gt; print
arch=arm
baudrate=38400
board=vexpress
board_name=vexpress
......
scriptaddr=0x88000000
stderr=serial
stdin=serial
stdout=serial
vendor=armltd

Environment size: 2656/262140 bytes
</code></pre>
<p>&#x81F3;&#x6B64;&#xFF0C;u-boot&#x542F;&#x52A8;&#x6210;&#x529F;&#xFF0C;&#x4E0B;&#x4E00;&#x6B65;&#x5F00;&#x59CB;&#x914D;&#x7F6E;u-boot&#x7684;&#x5185;&#x6838;&#x542F;&#x52A8;&#x53C2;&#x6570;&#xFF0C;&#x6765;&#x542F;&#x52A8;Linux&#x5185;&#x6838;&#xFF0C;&#x5E76;&#x6302;&#x5728;&#x6839;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x3002;</p>
<h2 id="3-&#x51C6;&#x5907;&#x5185;&#x6838;">3. &#x51C6;&#x5907;&#x5185;&#x6838;</h2>
<h3 id="31-&#x6307;&#x5B9A;&#x52A0;&#x8F7D;&#x5730;&#x5740;">3.1 &#x6307;&#x5B9A;&#x52A0;&#x8F7D;&#x5730;&#x5740;</h3>
<p>&#x4F7F;&#x7528;u-boot&#x5F15;&#x5BFC;&#x5185;&#x6838;&#x542F;&#x52A8;&#xFF0C;&#x9700;&#x8981;&#x5185;&#x6838;&#x7684;uImage&#x955C;&#x50CF;&#xFF1A;</p>
<blockquote>
<p>&#x9700;&#x8981;&#x5C06;&#x5185;&#x6838;&#x7F16;&#x8BD1;&#x4E3A;uImage&#x683C;&#x5F0F;&#xFF0C;&#x9700;&#x8981;&#x6307;&#x5B9A;uImage&#x5728;&#x5185;&#x5B58;&#x4E2D;&#x7684;&#x52A0;&#x8F7D;&#x5730;&#x5740;&#xFF0C;&#x7F16;&#x8BD1;&#x5185;&#x6838;&#x65F6;&#x6307;&#x5B9A;&#xFF1A;make LOADADDR=? uImage -j4</p>
</blockquote>
<p>&#x5982;&#x679C;&#x4E0D;&#x6307;&#x5B9A;LOADADDR&#x53C2;&#x6570;&#xFF0C;&#x7F16;&#x8BD1;&#x65F6;&#x4F1A;&#x62A5;&#x9519;&#xFF0C;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code class="lang-shell"># make ARCH=arm CROSS_COMPILE=arm-linux-gnueabi- uImage -j4 O=./object
make[1]: Entering directory &apos;/home/xiami/tool/linux-4.14.172/object&apos;
......
  Kernel: arch/arm/boot/Image is ready
  Kernel: arch/arm/boot/zImage is ready
multiple (or no) load addresses: 
This is incompatible with uImages
Specify LOADADDR on the commandline to build an uImage
../arch/arm/boot/Makefile:79: recipe for target &apos;arch/arm/boot/uImage&apos; failed
make[2]: *** [arch/arm/boot/uImage] Error 1
arch/arm/Makefile:338: recipe for target &apos;uImage&apos; failed
make[1]: *** [uImage] Error 2
make[1]: Leaving directory &apos;/home/xiami/tool/linux-4.14.172/object&apos;
Makefile:146: recipe for target &apos;sub-make&apos; failed
make: *** [sub-make] Error 2
</code></pre>
<p>&#x5728;&#x5185;&#x6838;&#x76EE;&#x5F55;&#x76F4;&#x63A5;&#x7F16;&#x8BD1;&#xFF1A;</p>
<pre><code class="lang-shell"># make LOADADDR=0x60003000 uImage -j4
</code></pre>
<pre><code class="lang-shell"># make ARCH=arm CROSS_COMPILE=arm-linux-gnueabi- LOADADDR=0x60003000 uImage -j4 O=./object
make[1]: Entering directory &apos;/home/xiami/tool/linux-4.14.172/object&apos;
......
  Kernel: arch/arm/boot/Image is ready
  Kernel: arch/arm/boot/zImage is ready
  UIMAGE  arch/arm/boot/uImage
&quot;mkimage&quot; command not found - U-Boot images will not be built
../arch/arm/boot/Makefile:79: recipe for target &apos;arch/arm/boot/uImage&apos; failed
make[2]: *** [arch/arm/boot/uImage] Error 1
arch/arm/Makefile:338: recipe for target &apos;uImage&apos; failed
make[1]: *** [uImage] Error 2
make[1]: Leaving directory &apos;/home/xiami/tool/linux-4.14.172/object&apos;
Makefile:146: recipe for target &apos;sub-make&apos; failed
make: *** [sub-make] Error 2
</code></pre>
<p>&#x7B2C;&#x4E00;&#x6B21;&#x7F16;&#x8BD1;&#x4F1A;&#x62A5;&#x9519;&#xFF0C;&#x63D0;&#x793A;&#x6CA1;&#x6709;&#x627E;&#x5230;mkimage&#x5DE5;&#x5177;&#xFF0C;&#x9700;&#x8981;&#x624B;&#x52A8;&#x5B89;&#x88C5;u-boot-tools&#x5373;&#x53EF;&#xFF1B;</p>
<pre><code class="lang-shell"># sudo apt-get install u-boot-tools
</code></pre>
<h3 id="32-&#x7F16;&#x8BD1;uimage">3.2 &#x7F16;&#x8BD1;uImage</h3>
<pre><code class="lang-shell"># make ARCH=arm CROSS_COMPILE=arm-linux-gnueabi- LOADADDR=0x60003000 uImage -j4 O=./object
make[1]: Entering directory &apos;/home/xiami/tool/linux-4.14.172/object&apos;
......
Load Address: 60003000
Entry Point:  60003000
  Kernel: arch/arm/boot/uImage is ready
make[1]: Leaving directory &apos;/home/xiami/tool/linux-4.14.172/object&apos;
</code></pre>
<p>&#x6216;&#x8005;&#x5728;Makefile&#x4E2D;&#x6DFB;&#x52A0;&#x52A0;&#x8F7D;&#x5730;&#x5740;&#x914D;&#x7F6E;&#xFF1A;</p>
<pre><code class="lang-shell"># vim arch/arm/boot/Makefile
LOADADDR ?= 0x60003000
</code></pre>
<p>&#x518D;&#x7F16;&#x8BD1;&#x751F;&#x6210;uImage&#x6587;&#x4EF6;:</p>
<pre><code class="lang-shell"># make uImage -j4
</code></pre>
<h2 id="4-qemu&#x7F51;&#x7EDC;&#x529F;&#x80FD;&#x8BBE;&#x7F6E;">4. Qemu&#x7F51;&#x7EDC;&#x529F;&#x80FD;&#x8BBE;&#x7F6E;</h2>
<p>Qemu&#x865A;&#x62DF;&#x673A;&#x5728;u-boot&#x542F;&#x52A8;&#x65F6;&#xFF0C;&#x9700;&#x8981;&#x5C06;uImage&#x52A0;&#x8F7D;&#x5230;&#x5185;&#x5B58;&#xFF0C;&#x800C;uImage&#x4ECE;&#x54EA;&#x91CC;&#x6765;&#xFF1F;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;TFTP&#x670D;&#x52A1;&#x5668;&#x4E0B;&#x8F7D;uImage&#x5230;&#x5185;&#x5B58;&#x6307;&#x5B9A;&#x5730;&#x5740;&#x3002;&#x800C;&#x5728;&#x8FD9;&#x4E4B;&#x524D;&#x9700;&#x8981;&#x901A;&#x8FC7;&#x6865;&#x63A5;&#x65B9;&#x5F0F;&#x5C06;&#x7F51;&#x7EDC;&#x94FE;&#x63A5;&#x5230;Ubuntu&#x7CFB;&#x7EDF;&#x3002;</p>
<h3 id="41-&#x914D;&#x7F6E;qemu&#x4E0E;&#x4E3B;&#x673A;&#x7684;&#x7F51;&#x7EDC;&#x8FDE;&#x63A5;">4.1 &#x914D;&#x7F6E;Qemu&#x4E0E;&#x4E3B;&#x673A;&#x7684;&#x7F51;&#x7EDC;&#x8FDE;&#x63A5;</h3>
<p>&#x91C7;&#x7528;&#x6865;&#x63A5;&#x7F51;&#x7EDC;&#x8FDE;&#x63A5;Host&#x4E3B;&#x673A;&#x901A;&#x4FE1;
&#x4E3B;&#x673A;&#x5185;&#x6838;&#x9700;&#x8981;&#x652F;&#x6301;tun/tap&#x6A21;&#x5757;</p>
<h3 id="42-&#x914D;&#x7F6E;ubuntu&#x4E3B;&#x673A;">4.2 &#x914D;&#x7F6E;Ubuntu&#x4E3B;&#x673A;</h3>
<h4 id="1-&#x5B89;&#x88C5;&#x5DE5;&#x5177;">1) &#x5B89;&#x88C5;&#x5DE5;&#x5177;</h4>
<p>&#x5B89;&#x88C5;&#x6865;&#x63A5;&#x7F51;&#x7EDC;&#x4F9D;&#x8D56;&#x7684;&#x4E24;&#x4E2A;&#x5DE5;&#x5177;&#xFF1A;</p>
<pre><code class="lang-shell"># sudo apt install uml-utilities bridge-utils
</code></pre>
<p>&#x521B;&#x5EFA;tun&#x8BBE;&#x5907;&#x6587;&#x4EF6;&#xFF1A;/dev/net/tun&#xFF08;&#x4E00;&#x822C;&#x4F1A;&#x81EA;&#x52A8;&#x521B;&#x5EFA;&#xFF09;</p>
<pre><code class="lang-shell"># ls /dev/net/tun -l
crw-rw-rw- 1 root root 10, 200 Mar 20 21:31 /dev/net/tun
</code></pre>
<h4 id="2-&#x914D;&#x7F6E;&#x7F51;&#x7EDC;">2) &#x914D;&#x7F6E;&#x7F51;&#x7EDC;</h4>
<p>&#x4FEE;&#x6539;/etc/network/interfaces&#x6587;&#x4EF6;&#x914D;&#x7F6E;&#x7F51;&#x7EDC;</p>
<pre><code class="lang-shell"># sudo vim /etc/network/interfaces
# interfaces(5) file used by ifup(8) and ifdown(8)
auto lo
iface lo inet loopback

auto br0
iface br0 inet dhcp
bridge_ports enp0s25
</code></pre>
<h4 id="3-&#x6DFB;&#x52A0;&#x7F51;&#x7EDC;&#x914D;&#x7F6E;&#x811A;&#x672C;">3) &#x6DFB;&#x52A0;&#x7F51;&#x7EDC;&#x914D;&#x7F6E;&#x811A;&#x672C;</h4>
<p>&#x914D;&#x7F6E;/etc/qemu-ifup&#x3001;/etc/qemu-ifdown&#x811A;&#x672C;&#xFF1B;</p>
<p>&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x5F53;qemu&#x4F7F;&#x7528;tap&#x8BBE;&#x5907;&#x65F6;&#xFF0C;&#x4F1A;&#x6267;&#x884C;/etc/qemu-ifup&#x548C;/etc/qemu-ifdown&#x8FD9;&#x4E24;&#x4E2A;&#x811A;&#x672C;&#xFF1B;&#x9700;&#x8981;&#x521B;&#x5EFA;&#x8FD9;&#x4E24;&#x4E2A;&#x811A;&#x672C;&#xFF0C;&#x5E76;&#x52A0;&#x4E0A;&#x53EF;&#x6267;&#x884C;&#x6743;&#x9650;&#xFF1B;</p>
<pre><code class="lang-shell"># cat /etc/qemu-ifup
#!/bin/sh

echo sudo tunctl -u $(id -un) -t $1
sudo tunctl -u $(id -un) -t $1

echo sudo ifconfig $1 0.0.0.0 promisc up
sudo ifconfig $1 0.0.0.0 promisc up

echo sudo brctl addif br0 $1
sudo brctl addif br0 $1

echo brctl show
brctl show

# sudo ifconfig br0 192.168.1.102
</code></pre>
<pre><code class="lang-shell"># ifconfig
enp0s25: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500
        inet 192.168.1.102  netmask 255.255.255.0  broadcast 192.168.1.255
        inet6 ****::***:****:****:****  prefixlen 64  scopeid 0x20&lt;link&gt;
        ether **:**:**:**:**:**  txqueuelen 1000  (Ethernet)
        RX packets 146587  bytes 69384714 (69.3 MB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 117583  bytes 13689404 (13.6 MB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
        device interrupt 20  memory 0xf3900000-f3920000
</code></pre>
<p>&#x67E5;&#x8BE2;&#x5230;enp0s25&#x7684;IP&#x5730;&#x5740;&#x662F;192.168.1.102&#xFF0C;&#x9700;&#x8981;&#x5C06;br0&#x914D;&#x7F6E;&#x5728;&#x540C;&#x4E00;&#x4E2A;192.168.1.<em>*</em>&#x7F51;&#x6BB5;&#xFF1B;</p>
<pre><code class="lang-shell"># cat /etc/qemu-ifdown
#!/bin/sh

echo sudo brctl delif br0 $1
sudo brctl delif br0 $1

echo sudo tunctl -d $1
sudo tunctl -d $1

echo brctl show
brctl show
</code></pre>
<pre><code class="lang-shell"># chmod a+x /etc/qemu-ifup
# chmod a+x /etc/qemu-ifdown
</code></pre>
<p>&#x91CD;&#x542F;PC&#xFF0C;&#x4F7F;&#x65B0;&#x7684;/etc/network/interfaces&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x751F;&#x6548;&#xFF1B;</p>
<h3 id="43-&#x5173;&#x95ED;&#x9632;&#x706B;&#x5899;">4.3 &#x5173;&#x95ED;&#x9632;&#x706B;&#x5899;</h3>
<h4 id="1-&#x5173;&#x95ED;&#x9632;&#x706B;&#x5899;">1) &#x5173;&#x95ED;&#x9632;&#x706B;&#x5899;</h4>
<pre><code class="lang-shell"># sudo ufw disable
Firewall stopped and disabled on system startup
</code></pre>
<h4 id="2-&#x67E5;&#x770B;&#x5F53;&#x524D;&#x9632;&#x706B;&#x5899;&#x72B6;&#x6001;">2) &#x67E5;&#x770B;&#x5F53;&#x524D;&#x9632;&#x706B;&#x5899;&#x72B6;&#x6001;</h4>
<pre><code class="lang-shell"># sudo ufw status
Status: inactive
</code></pre>
<p>&#x53E6;&#x5916;&#xFF0C;&#x9644;&#x4E0A;&#x5F00;&#x542F;&#x9632;&#x706B;&#x5899;&#x7684;&#x64CD;&#x4F5C;&#x65B9;&#x6CD5;&#xFF1A;</p>
<pre><code class="lang-shell"># ufw enable
</code></pre>
<h3 id="44-&#x91CD;&#x542F;&#x7CFB;&#x7EDF;&#xFF0C;&#x4F7F;&#x914D;&#x7F6E;&#x751F;&#x6548;">4.4 &#x91CD;&#x542F;&#x7CFB;&#x7EDF;&#xFF0C;&#x4F7F;&#x914D;&#x7F6E;&#x751F;&#x6548;</h3>
<pre><code class="lang-shell"># reboot
</code></pre>
<p>&#x6216;&#x8005;&#xFF1A;</p>
<pre><code class="lang-shell"># init 6
</code></pre>
<h3 id="45-&#x67E5;&#x770B;qemu&#x7684;&#x7F51;&#x7EDC;&#x73AF;&#x5883;">4.5 &#x67E5;&#x770B;Qemu&#x7684;&#x7F51;&#x7EDC;&#x73AF;&#x5883;</h3>
<pre><code class="lang-shell"># ifconfig
br0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500
        inet 192.168.1.102  netmask 255.255.255.0  broadcast 192.168.1.255
        inet6 ****::***:****:****:****  prefixlen 64  scopeid 0x20&lt;link&gt;
        ether **:**:**:**:**:**  txqueuelen 1000  (Ethernet)
        RX packets 44667  bytes 16853864 (16.8 MB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 45161  bytes 32391098 (32.3 MB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
</code></pre>
<p>&#x865A;&#x62DF;&#x7F51;&#x53E3;br0&#x5373;Qemu&#x865A;&#x62DF;&#x673A;&#x4E0E;Linux&#x4E3B;&#x673A;&#x901A;&#x8BAF;&#x7684;&#x7F51;&#x53E3;&#xFF1B;</p>
<p>&#x5728;u-boot&#x4E2D;&#x6D4B;&#x8BD5;&#x7F51;&#x7EDC;&#x662F;&#x5426;&#x63A5;&#x901A;&#xFF1A;</p>
<pre><code class="lang-shell">=&gt; ping 192.168.1.102
smc911x: MAC 52:54:00:12:34:56
smc911x: detected LAN9118 controller
smc911x: phy initialized
smc911x: MAC 52:54:00:12:34:56
Using smc911x-0 device
smc911x: MAC 52:54:00:12:34:56
host 192.168.1.102 is alive
</code></pre>
<h2 id="5-&#x5B89;&#x88C5;tftp&#x670D;&#x52A1;&#x5668;">5. &#x5B89;&#x88C5;TFTP&#x670D;&#x52A1;&#x5668;</h2>
<p>&#x521B;&#x5EFA;TFTP&#x670D;&#x52A1;&#x5668;&#xFF0C;&#x7528;&#x6765;&#x7ED9;Qemu&#x6A21;&#x62DF;&#x5F00;&#x53D1;&#x677F;&#x542F;&#x52A8;uImage&#x65F6;&#xFF0C;&#x4E0B;&#x8F7D;uImage&#x5230;&#x5185;&#x5B58;&#x4E2D;&#x3002;</p>
<h3 id="51-&#x5B89;&#x88C5;tftp&#x5DE5;&#x5177;">5.1 &#x5B89;&#x88C5;TFTP&#x5DE5;&#x5177;</h3>
<p>&#x5B89;&#x88C5;Linux&#x4E3B;&#x673A;Host&#x7684;TFTP&#x670D;&#x52A1;&#x5668;&#x5DE5;&#x5177;&#xFF1A;</p>
<pre><code class="lang-shell"># sudo apt install tftp-hpa tftpd-hpa xinetd
</code></pre>
<h3 id="52-&#x914D;&#x7F6E;">5.2 &#x914D;&#x7F6E;</h3>
<h4 id="1-&#x4FEE;&#x6539;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#xFF0C;&#x8BBE;&#x7F6E;tftp&#x670D;&#x52A1;&#x5668;&#x76EE;&#x5F55;">1) &#x4FEE;&#x6539;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#xFF0C;&#x8BBE;&#x7F6E;TFTP&#x670D;&#x52A1;&#x5668;&#x76EE;&#x5F55;</h4>
<pre><code class="lang-shell"># sudo vim /etc/default/tftpd-hpa
......
TFTP_USERNAME=&quot;xiami&quot;
TFTP_DIRECTORY=&quot;/home/xiami/qemu/boot-uboot&quot;
TFTP_ADDRESS=&quot;0.0.0.0:69&quot;
TFTP_OPTIONS=&quot;-l -c -s&quot;
......
</code></pre>
<blockquote>
<p>&#x8BF4;&#x660E;&#xFF1A;</p>
<p>TFTP_USERNAME&#xFF1A;&#x5FC5;&#x987B;&#x8BBE;&#x7F6E;&#x4E3A;&#x5F53;&#x524D;&#x7684;&#x7528;&#x6237;&#x540D;&#xFF0C;&#x6216;&#xFF1A;root</p>
<p>TFTP_DIRECTORY&#xFF1A;&#x8BBE;&#x5B9A;TFTP&#x7684;&#x6839;&#x76EE;&#x5F55;</p>
<p>TFTP_ADDRESS&#xFF1A;</p>
<p>TFTP_OPTIONS&#xFF1A;TFTP&#x542F;&#x52A8;&#x53C2;&#x6570;</p>
<p>&#x200B;    -l: &#x4EE5;standalone/listen&#x6A21;&#x5F0F;&#x542F;&#x52A8;TFTP&#x670D;&#x52A1;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x4ECE;inetd&#x542F;&#x52A8;&#xFF0C;&#x4E0D;&#x9700;&#x8981;&#x5B89;&#x88C5;xinetd</p>
<p>&#x200B;    -c: &#x53EF;&#x521B;&#x5EFA;&#x65B0;&#x6587;&#x4EF6;&#xFF0C;&#x9ED8;&#x8BA4;&#xFF0C;TFTP&#x53EA;&#x5141;&#x8BB8;&#x8986;&#x76D6;&#x539F;&#x6587;&#x4EF6;&#xFF0C;&#x4E0D;&#x80FD;&#x521B;&#x5EFA;&#x65B0;&#x6587;&#x4EF6;</p>
<p>&#x200B;    -s: &#x6539;&#x53D8;TFTP&#x542F;&#x52A8;&#x7684;&#x6839;&#x76EE;&#x5F55;&#xFF1B;&#x52A0;&#x5165;-s&#x540E;&#xFF0C;&#x5BA2;&#x6237;&#x7AEF;&#x4F7F;&#x7528;TFTP&#x65F6;&#xFF0C;&#x4E0D;&#x518D;&#x9700;&#x8981;&#x8F93;&#x5165;&#x6307;&#x5B9A;&#x76EE;&#x5F55;&#xFF0C;&#x586B;&#x5199;&#x6587;&#x4EF6;&#x7684;&#x5B8C;&#x6574;&#x8DEF;&#x5F84;&#xFF0C;&#x800C;&#x662F;&#x4F7F;&#x7528;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x4E2D;&#x5199;&#x597D;&#x7684;&#x76EE;&#x5F55;&#xFF1B;</p>
</blockquote>
<h4 id="2-linux&#x4E3B;&#x673A;&#x4E0A;&#x521B;&#x5EFA;tftp&#x76EE;&#x5F55;">2) Linux&#x4E3B;&#x673A;&#x4E0A;&#x521B;&#x5EFA;tftp&#x76EE;&#x5F55;</h4>
<pre><code class="lang-shell"># mkdir /home/mcy/tftpboot
# chmod 777 /home/mcy/tftpboot
</code></pre>
<h4 id="3-&#x91CD;&#x542F;tftp&#x670D;&#x52A1;">3) &#x91CD;&#x542F;tftp&#x670D;&#x52A1;</h4>
<pre><code class="lang-powershell"><span class="hljs-comment"># sudo /etc/init.d/tftpd-hpa restart</span>
[ ok ] Restarting tftpd-hpa (via systemctl): tftpd-hpa.service.
</code></pre>
<h3 id="53-&#x6D4B;&#x8BD5;&#x9A8C;&#x8BC1;">5.3 &#x6D4B;&#x8BD5;&#x9A8C;&#x8BC1;</h3>
<h4 id="1-&#x6D4B;&#x8BD5;tftp&#x670D;&#x52A1;&#x5668;">1) &#x6D4B;&#x8BD5;tftp&#x670D;&#x52A1;&#x5668;</h4>
<p>&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x4E09;&#x79CD;&#x65B9;&#x6CD5;&#xFF0C;1. &#x8F93;&#x5165;&#x771F;&#x5B9E;&#x7684;IP&#x5730;&#x5740;&#xFF1B;2. &#x7528;localhost&#x4EE3;&#x66FF;&#x4E3B;&#x673A;&#xFF1B;3. &#x4F7F;&#x7528;&#x5730;&#x5740;127.0.0.1&#xFF0C;&#x8FD9;&#x4E2A;IP&#x5730;&#x5740;&#x59CB;&#x7EC8;&#x4EE3;&#x8868;&#x672C;&#x673A;IP&#xFF1B;</p>
<p>tftp 192.168.1.102</p>
<p>tftp localhost</p>
<p>tftp 127.0.0.1</p>
<h4 id="2-tftp&#x547D;&#x4EE4;&#x884C;&#x7684;&#x57FA;&#x672C;&#x547D;&#x4EE4;">2) TFTP&#x547D;&#x4EE4;&#x884C;&#x7684;&#x57FA;&#x672C;&#x547D;&#x4EE4;</h4>
<p>put: &#x5C06;&#x6587;&#x4EF6;&#x4E0A;&#x4F20;&#x5230;TFTP&#x6839;&#x76EE;&#x5F55;</p>
<p>get: &#x53D6;&#x5F97;TFTP&#x6839;&#x76EE;&#x5F55;&#x4E0A;&#x7684;&#x6587;&#x4EF6;</p>
<p>quit/q: &#x9000;&#x51FA;TFTP&#x670D;&#x52A1;</p>
<h2 id="6-&#x8BBE;&#x7F6E;u-boot&#x4E2D;&#x7684;&#x5185;&#x6838;&#x542F;&#x52A8;&#x53C2;&#x6570;">6. &#x8BBE;&#x7F6E;u-boot&#x4E2D;&#x7684;&#x5185;&#x6838;&#x542F;&#x52A8;&#x53C2;&#x6570;</h2>
<h3 id="61-&#x8BBE;&#x7F6E;u-boot&#x53C2;&#x6570;">6.1 &#x8BBE;&#x7F6E;u-boot&#x53C2;&#x6570;</h3>
<p>u-boot&#x80FD;&#x591F;&#x6B63;&#x5E38;&#x542F;&#x52A8;&#x8FD8;&#x4E0D;&#x8DB3;&#x4EE5;&#x5F15;&#x5BFC;&#x5185;&#x6838;&#x542F;&#x52A8;&#xFF0C;&#x9700;&#x8981;&#x5728;u-boot&#x4E2D;&#x8BBE;&#x7F6E;&#x4E00;&#x4E9B;&#x542F;&#x52A8;&#x53C2;&#x6570;&#xFF0C;&#x5728;&#x5F15;&#x5BFC;&#x5185;&#x6838;&#x542F;&#x52A8;&#x65F6;&#xFF0C;&#x5C06;&#x8FD9;&#x4E9B;&#x542F;&#x52A8;&#x53C2;&#x6570;&#x4F20;&#x9012;&#x7ED9;&#x5185;&#x6838;&#xFF1B;&#x5185;&#x6838;&#x542F;&#x52A8;&#x540E;&#x6302;&#x8F7D;SD&#x5361;&#x4E2D;&#x7684;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#xFF1B;</p>
<p>&#x8FD9;&#x4E9B;&#x542F;&#x52A8;&#x53C2;&#x6570;&#xFF0C;&#x53EF;&#x4EE5;&#x5728;u-boot&#x542F;&#x52A8;&#x540E;&#xFF0C;&#x624B;&#x52A8;&#x8BBE;&#x7F6E;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x5728;u-boot&#x4E2D;&#xFF0C;&#x628A;&#x5185;&#x6838;&#x542F;&#x52A8;&#x53C2;&#x6570;&#x5199;&#x5165;vexpress_common.h&#x5934;&#x6587;&#x4EF6;&#xFF1B;</p>
<h4 id="1&#xFF09;-&#x5199;&#x5165;u-boot&#x5934;&#x6587;&#x4EF6;">1&#xFF09; &#x5199;&#x5165;u-boot&#x5934;&#x6587;&#x4EF6;</h4>
<p>&#x4FEE;&#x6539;vexpress_common.h&#x5934;&#x6587;&#x4EF6;&#xFF0C;&#x6DFB;&#x52A0;&#x5185;&#x6838;&#x542F;&#x52A8;&#x9700;&#x8981;&#x7684;&#x53C2;&#x6570;&#xFF1A;</p>
<pre><code class="lang-c"><span class="hljs-meta"># vim <span class="hljs-meta-keyword">include</span>/configs/vexpress_common.h</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CONFIG_BOOTCOMMAND  \
    <span class="hljs-string">&quot;tftp 0x60003000 uImage; tftp 0x60500000 vexpress-v2p-ca9.dtb;  \
    setenv bootargs &apos;root=/dev/mmcblk0 rw   \
    init=/linuxrc   \
    ip=192.168.1.110 console=ttyAMA0&apos;;  \
    bootm 0x60003000 - 0x60500000;&quot;</span></span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CONFIG_IPADDR   192.168.1.110</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CONFIG_SERVERIP 192.168.1.104</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CONFIGN_NETMASK 255.255.255.0</span>
</code></pre>
<p>&#x53C2;&#x6570;&#x8BF4;&#x660E;&#xFF1A;</p>
<blockquote>
<p>CONFIG_IPADDR&#xFF1A; &#x8BBE;&#x5907;&#x7684;&#x672C;&#x5730;IP&#x5730;&#x5740;</p>
<p>CONFIG_SERVERIP&#xFF1A; TFTP&#x4E0B;&#x8F7D;&#x65F6;&#x7684;&#x670D;&#x52A1;&#x5668;IP&#x5730;&#x5740;</p>
<p>CONFIG_BOOTCOMMAND&#xFF1A; &#x5185;&#x6838;&#x542F;&#x52A8;&#x7684;&#x53C2;&#x6570;&#x8BBE;&#x7F6E;&#xFF0C;&#x5305;&#x542B;boot_args</p>
</blockquote>
<h4 id="2&#xFF09;-&#x624B;&#x52A8;&#x8BBE;&#x7F6E;">2&#xFF09; &#x624B;&#x52A8;&#x8BBE;&#x7F6E;</h4>
<p>&#x5728;u-boot&#x542F;&#x52A8;&#x4E4B;&#x540E;&#xFF0C;&#x624B;&#x52A8;&#x8BBE;&#x7F6E;&#x73AF;&#x5883;&#x53D8;&#x91CF;&#xFF1A;</p>
<pre><code class="lang-shell">=&gt; setenv ipaddr 192.168.1.110
=&gt; setenv serverip 192.168.1.102
=&gt; setenv bootargs &apos;root=/dev/mmcblk0 rw init=/linuxrc ip=192.168.1.110 console=ttyAMA0&apos;
</code></pre>
<p>&#x624B;&#x52A8;&#x8BBE;&#x7F6E;tftp&#x4E0B;&#x8F7D;&#xFF1A;</p>
<pre><code class="lang-shell">=&gt; tftp 0x60003000 uImage    // tftp&#x4E0B;&#x8F7D;&#x5185;&#x6838;&#x955C;&#x50CF;
=&gt; tftp 0x60500000 vexpress-v2p-ca9.dtb        // tftp&#x4E0B;&#x8F7D;&#x8BBE;&#x5907;&#x6811;
=&gt; bootm 0x60003000 - 0x60500000    // &#x542F;&#x52A8;&#x5185;&#x6838;
</code></pre>
<p>&#x624B;&#x52A8;&#x8BBE;&#x7F6E;&#x7528;&#x6765;&#x8C03;&#x8BD5;&#x6BD4;&#x8F83;&#x65B9;&#x4FBF;&#xFF0C;&#x4F46;&#x662F;&#x6B63;&#x5E38;&#x4F7F;&#x7528;&#x65F6;&#xFF0C;&#x8FD8;&#x662F;&#x5C06;&#x8BBE;&#x7F6E;&#x53C2;&#x6570;&#x5199;&#x5165;u-boot&#x7684;vexpress_common.h&#x5934;&#x6587;&#x4EF6;&#x6BD4;&#x8F83;&#x597D;&#xFF0C;&#x514D;&#x5F97;&#x6BCF;&#x6B21;&#x542F;&#x52A8;&#x90FD;&#x9700;&#x8981;&#x8F93;&#x5165;&#x8FD9;&#x4E48;&#x591A;&#x547D;&#x4EE4;&#xFF1B;</p>
<h4 id="3&#xFF09;-&#x8BBE;&#x7F6E;&#x6302;&#x8F7D;nfs&#x7F51;&#x7EDC;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;">3&#xFF09; &#x8BBE;&#x7F6E;&#x6302;&#x8F7D;nfs&#x7F51;&#x7EDC;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;</h4>
<p>&#x5982;&#x679C;&#x9700;&#x8981;&#x901A;&#x8FC7;nfs&#x6302;&#x8F7D;&#x7F51;&#x7EDC;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#xFF0C;&#x9700;&#x8981;&#x5728;u-boot&#x4E2D;&#xFF0C;&#x8BBE;&#x7F6E;boot_args&#xFF0C;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code class="lang-c"><span class="hljs-meta"># vim <span class="hljs-meta-keyword">include</span>/configs/vexpress_common.h</span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CONFIG_BOOTCOMMAND  \
    <span class="hljs-string">&quot;tftp 0x60003000 uImage; tftp 0x60500000 vexpress-v2p-ca9.dtb;  \
    setenv bootargs &apos;root=/dev/nfs rw   \
    nfsroot=192.168.1.102:/home/xiami/qemu/nfs_root init=/linuxrc   \
    ip=192.168.1.110 console=ttyAMA0&apos;;  \
    bootm 0x60003000 - 0x60500000;&quot;</span></span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CONFIG_IPADDR   192.168.1.110</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CONFIG_SERVERIP 192.168.1.104</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CONFIGN_NETMASK 255.255.255.0</span>
</code></pre>
<p>&#x91CD;&#x65B0;&#x7F16;&#x8BD1;u-boot&#xFF1B;&#x542F;&#x52A8;Qemu&#x9A8C;&#x8BC1;</p>
<pre><code class="lang-shell">=&gt; print bootcmd
bootcmd=tftp 0x60003000 uImage; tftp 0x60500000 vexpress-v2p-ca9.dtb; setenv bootargs &apos;root=/dev/nfs rw nfsroot=192.168.1.102:/home/xiami/qemu/boot-uboot/rootfs init=/linuxrc ip=192.168.1.110 console=ttyAMA0&apos;; bootm 0x60003000 - 0x60500000;
=&gt; print ipaddr
ipaddr=192.168.1.110
=&gt; print serverip
serverip=192.168.1.102
</code></pre>
<p>&#x7F51;&#x7EDC;&#x8FD8;&#x6CA1;&#x6709;ping&#x901A;&#xFF1A;</p>
<pre><code class="lang-shell">=&gt; ping 192.168.1.102
smc911x: MAC 52:54:00:12:34:56
smc911x: detected LAN9118 controller
smc911x: phy initialized
smc911x: MAC 52:54:00:12:34:56
Using smc911x-0 device

ARP Retry count exceeded; starting again
smc911x: MAC 52:54:00:12:34:56
ping failed; host 192.168.1.102 is not alive
</code></pre>
<p>&#x8FD9;&#x90E8;&#x5206;&#x5728;&#x4E0B;&#x4E00;&#x8282;&#x4E2D;&#x518D;&#x8BB2;&#x8FF0;&#xFF0C;&#x6B64;&#x5904;&#x7565;&#x8FC7;&#xFF1B;</p>
<h3 id="62-&#x542F;&#x52A8;&#x9A8C;&#x8BC1;">6.2 &#x542F;&#x52A8;&#x9A8C;&#x8BC1;</h3>
<h4 id="1&#xFF09;-&#x542F;&#x52A8;qemu&#xFF0C;&#x5E76;&#x68C0;&#x67E5;&#x542F;&#x52A8;&#x53C2;&#x6570;">1&#xFF09; &#x542F;&#x52A8;Qemu&#xFF0C;&#x5E76;&#x68C0;&#x67E5;&#x542F;&#x52A8;&#x53C2;&#x6570;</h4>
<pre><code class="lang-powershell"><span class="hljs-comment"># cat boot.sh</span>
<span class="hljs-comment">#! /bin/sh</span>
sudo qemu-system-arm \
    -M vexpress-a9 \
    -m <span class="hljs-number">512</span>M \
    -kernel ./u-boot \
    -nographic \
    -append console=ttyAMA0 \
    -sd rootfs.ext3 \
    -net nic \
    -net tap
</code></pre>
<p>u-boot&#x542F;&#x52A8;&#x540E;&#xFF0C;&#x67E5;&#x770B;u-boot&#x4E2D;&#x7684;&#x73AF;&#x5883;&#x53D8;&#x91CF;&#xFF1A;</p>
<pre><code class="lang-shell">=&gt; print bootcmd
bootcmd=tftp 0x60003000 uImage; tftp 0x60500000 vexpress-v2p-ca9.dtb; setenv bootargs &apos;root=/dev/mmcblk0 rw init=/linuxrc ip=192.168.1.110 console=ttyAMA0&apos;; bootm 0x60003000 - 0x60500000;
=&gt; print ipaddr
ipaddr=192.168.1.110
=&gt; print serverip
serverip=192.168.1.102
</code></pre>
<p>&#x68C0;&#x67E5;tftp&#x4E0B;&#x8F7D;&#x7F51;&#x7EDC;&#xFF0C;&#x5728;&#x5F00;&#x53D1;&#x677F;&#x7684;u-boot&#x4E2D;&#xFF0C;ping&#x672C;&#x5730;PC&#x7684;tftp&#x670D;&#x52A1;&#x5668;&#xFF0C;&#x6CE8;&#x610F;&#xFF0C;&#x4E0D;&#x8981;&#x7528;&#x7535;&#x8111;ping&#x5F00;&#x53D1;&#x677F;&#xFF0C;&#x56E0;&#x4E3A;u-boot&#x4E2D;&#x6CA1;&#x6709;&#x56DE;&#x5E94;&#x673A;&#x5236;&#xFF0C;&#x662F;ping&#x4E0D;&#x901A;&#x5F00;&#x53D1;&#x677F;&#x7684;&#xFF1B;</p>
<pre><code class="lang-shell">=&gt; ping 192.168.1.102
smc911x: MAC 52:54:00:12:34:56
smc911x: detected LAN9118 controller
smc911x: phy initialized
smc911x: MAC 52:54:00:12:34:56
Using smc911x-0 device
smc911x: MAC 52:54:00:12:34:56
host 192.168.1.102 is alive
</code></pre>
<h4 id="2&#xFF09;-&#x542F;&#x52A8;&#x9A8C;&#x8BC1;">2&#xFF09; &#x542F;&#x52A8;&#x9A8C;&#x8BC1;</h4>
<pre><code># ./boot-uboot-tftp.sh 
Booting qemu vexpress-ca9
WARNING: Image format was not specified for &apos;rootfs.ext3&apos; and probing guessed raw.
         Automatically detecting the format is dangerous for raw images, write operations on block 0 will be restricted.
         Specify the &apos;raw&apos; format explicitly to remove the restrictions.
sudo tunctl -u root -t tap0
TUNSETIFF: Device or resource busy
sudo ifconfig tap0 0.0.0.0 promisc up
sudo brctl addif br0 tap0
brctl show
bridge name    bridge id        STP enabled    interfaces
br0        8000.0021ccd65a96    no        enp0s25
                            tap0

U-Boot 2020.01 (Mar 22 2020 - 16:51:32 +0800)

DRAM:  512 MiB
WARNING: Caches not enabled
Flash: 128 MiB
MMC:   MMC: 0
*** Warning - bad CRC, using default environment

In:    serial
Out:   serial
Err:   serial
Net:   smc911x-0
Hit any key to stop autoboot:  0 
smc911x: MAC 52:54:00:12:34:56
smc911x: detected LAN9118 controller
smc911x: phy initialized
smc911x: MAC 52:54:00:12:34:56
Using smc911x-0 device
TFTP from server 192.168.1.102; our IP address is 192.168.1.110
Filename &apos;uImage&apos;.
Load address: 0x60003000
Loading: #################################################################
     #################################################################
     #################################################################
     #################################################################
     ###########
     8.7 MiB/s
done
Bytes transferred = 3971576 (3c99f8 hex)
smc911x: MAC 52:54:00:12:34:56
smc911x: MAC 52:54:00:12:34:56
smc911x: detected LAN9118 controller
smc911x: phy initialized
smc911x: MAC 52:54:00:12:34:56
Using smc911x-0 device
TFTP from server 192.168.1.102; our IP address is 192.168.1.110
Filename &apos;vexpress-v2p-ca9.dtb&apos;.
Load address: 0x60500000
Loading: ##
     4.7 MiB/s
done
Bytes transferred = 14692 (3964 hex)
smc911x: MAC 52:54:00:12:34:56
## Booting kernel from Legacy Image at 60003000 ...
   Image Name:   Linux-4.14.172
   Image Type:   ARM Linux Kernel Image (uncompressed)
   Data Size:    3971512 Bytes = 3.8 MiB
   Load Address: 60003000
   Entry Point:  60003000
   Verifying Checksum ... OK
## Flattened Device Tree blob at 60500000
   Booting using the fdt blob at 0x60500000
   Loading Kernel Image
   Loading Device Tree to 7fe81000, end 7fe87963 ... OK

Starting kernel ...

Booting Linux on physical CPU 0x0
Linux version 4.14.172 (xiami@xiami) (gcc version 7.5.0 (Ubuntu/Linaro 7.5.0-3ubuntu1~18.04)) #1 SMP Sun Mar 15 12:27:54 CST 2020
CPU: ARMv7 Processor [410fc090] revision 0 (ARMv7), cr=10c5387d
CPU: PIPT / VIPT nonaliasing data cache, VIPT nonaliasing instruction cache
OF: fdt: Machine model: V2P-CA9
Memory policy: Data cache writeback
CPU: All CPU(s) started in SVC mode.
percpu: Embedded 15 pages/cpu s32396 r8192 d20852 u61440
Built 1 zonelists, mobility grouping on.  Total pages: 130048
Kernel command line: root=/dev/mmcblk0 rw       init=/linuxrc       ip=192.168.1.110 console=ttyAMA0
log_buf_len individual max cpu contribution: 4096 bytes
log_buf_len total cpu_extra contributions: 12288 bytes
log_buf_len min size: 16384 bytes
log_buf_len: 32768 bytes
early log buf free: 14980(91%)
PID hash table entries: 2048 (order: 1, 8192 bytes)
Dentry cache hash table entries: 65536 (order: 6, 262144 bytes)
Inode-cache hash table entries: 32768 (order: 5, 131072 bytes)
Memory: 509616K/524288K available (6144K kernel code, 403K rwdata, 1372K rodata, 1024K init, 161K bss, 14672K reserved, 0K cma-reserved)
Virtual kernel memory layout:
    vector  : 0xffff0000 - 0xffff1000   (   4 kB)
    fixmap  : 0xffc00000 - 0xfff00000   (3072 kB)
    vmalloc : 0xa0800000 - 0xff800000   (1520 MB)
    lowmem  : 0x80000000 - 0xa0000000   ( 512 MB)
    modules : 0x7f000000 - 0x80000000   (  16 MB)
      .text : 0x80008000 - 0x80700000   (7136 kB)
      .init : 0x80900000 - 0x80a00000   (1024 kB)
      .data : 0x80a00000 - 0x80a64f90   ( 404 kB)
       .bss : 0x80a6bd00 - 0x80a94468   ( 162 kB)
SLUB: HWalign=64, Order=0-3, MinObjects=0, CPUs=4, Nodes=1
Hierarchical RCU implementation.
    RCU event tracing is enabled.
    RCU restricting CPUs from NR_CPUS=8 to nr_cpu_ids=4.

......

IP-Config: Guessing netmask 255.255.255.0
IP-Config: Complete:
     device=eth0, hwaddr=52:54:00:12:34:56, ipaddr=192.168.1.110, mask=255.255.255.0, gw=255.255.255.255
     host=192.168.1.110, domain=, nis-domain=(none)
     bootserver=255.255.255.255, rootserver=255.255.255.255, rootpath=
ALSA device list:
  #0: ARM AC&apos;97 Interface PL041 rev0 at 0x10004000, irq 30
EXT4-fs (mmcblk0): mounting ext3 file system using the ext4 subsystem
random: fast init done
EXT4-fs (mmcblk0): recovery complete
EXT4-fs (mmcblk0): mounted filesystem with ordered data mode. Opts: (null)
VFS: Mounted root (ext3 filesystem) on device 179:0.
Freeing unused kernel memory: 1024K
random: crng init done
Hello Linux Qemu!

Please press Enter to activate this console. 
/ #
</code></pre><pre><code>=&gt; reset
resetting ...


U-Boot 2017.05 (Jul 24 2019 - 21:52:28 +0800)

DRAM:  512 MiB
WARNING: Caches not enabled
Flash: 128 MiB
MMC:   MMC: 0
*** Warning - bad CRC, using default environment

In:    serial
Out:   serial
Err:   serial
Net:   smc911x-0
Hit any key to stop autoboot:  0 
smc911x: MAC 52:54:00:12:34:56
smc911x: detected LAN9118 controller
smc911x: phy initialized
smc911x: MAC 52:54:00:12:34:56
Using smc911x-0 device
TFTP from server 192.168.1.104; our IP address is 192.168.1.110
Filename &apos;uImage&apos;.
Load address: 0x60003000
Loading: #################################################################
     #################################################################
     #################################################################
     ##################################################
     1.3 MiB/s
done
Bytes transferred = 3581920 (36a7e0 hex)
smc911x: MAC 52:54:00:12:34:56
smc911x: MAC 52:54:00:12:34:56
smc911x: detected LAN9118 controller
smc911x: phy initialized
smc911x: MAC 52:54:00:12:34:56
Using smc911x-0 device
TFTP from server 192.168.1.104; our IP address is 192.168.1.110
Filename &apos;vexpress-v2p-ca9.dtb&apos;.
Load address: 0x60500000
Loading: #
     250 KiB/s
done
Bytes transferred = 14360 (3818 hex)
smc911x: MAC 52:54:00:12:34:56
## Booting kernel from Legacy Image at 60003000 ...
   Image Name:   Linux-4.4.157
   Image Type:   ARM Linux Kernel Image (uncompressed)
   Data Size:    3581856 Bytes = 3.4 MiB
   Load Address: 60003000
   Entry Point:  60003000
   Verifying Checksum ... OK
## Flattened Device Tree blob at 60500000
   Booting using the fdt blob at 0x60500000
   Loading Kernel Image ... OK
   Loading Device Tree to 7fed4000, end 7feda817 ... OK
</code></pre><p>&#x81F3;&#x6B64;&#xFF0C;&#x901A;&#x8FC7;u-boot&#x52A0;&#x8F7D;kernel&#xFF0C;&#x5E76;&#x6302;&#x8F7D;SD&#x5361;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x5DF2;&#x7ECF;&#x6210;&#x529F;&#xFF1B;</p>
<h3 id="7-&#x603B;&#x7ED3;">7. &#x603B;&#x7ED3;</h3>
<p>SD&#x5361;&#x4E2D;rootfs&#x76EE;&#x5F55;&#x662F;&#x4E00;&#x4E2A;&#x7B80;&#x6613;&#x7684;&#x6839;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#xFF0C;&#x53EF;&#x4EE5;&#x5C06;&#x5B83;&#x5236;&#x4F5C;&#x6210;&#x4E00;&#x4E2A;&#x955C;&#x50CF;&#x6587;&#x4EF6;&#xFF0C;&#x5C06;&#x955C;&#x50CF;&#x6587;&#x4EF6;&#x70E7;&#x5199;&#x5230;&#x5F00;&#x53D1;&#x677F;&#xFF0C;&#x6216;&#x8005;&#x901A;&#x8FC7;Qemu&#x4E2D;&#x7684;u-boot&#x542F;&#x52A8;Linux&#x5185;&#x6838;&#x540E;&#x6302;&#x8F7D;&#x5230;&#x955C;&#x50CF;&#x6587;&#x4EF6;&#x4E0A;&#x3002;&#x4E5F;&#x53EF;&#x4EE5;&#x8BBE;&#x7F6E;&#x4E3A;&#x901A;&#x8FC7;NFS&#x7F51;&#x7EDC;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x542F;&#x52A8;&#xFF0C;&#x53C2;&#x8003;&#x4E0B;&#x4E00;&#x7BC7;&#x6587;&#x7AE0;&#x300A;<a href="https://www.jianshu.com/p/cf46f7225db6" target="_blank">Qemu&#x642D;&#x5EFA;ARM vexpress&#x5F00;&#x53D1;&#x73AF;&#x5883;(3)----NFS&#x7F51;&#x7EDC;&#x6839;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;</a>&#x300B;&#x3002;</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="Qemu搭建ARM-vexpress开发环境-1.html" class="navigation navigation-prev " aria-label="Previous page: Qemu搭建ARM-vexpress开发环境-1">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="Qemu搭建ARM-vexpress开发环境-3-NFS网络根文件系统.html" class="navigation navigation-next " aria-label="Next page: Qemu搭建ARM-vexpress开发环境-3-NFS网络根文件系统">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Qemu搭建ARM-vexpress开发环境-2-u-boot启动kernel","level":"1.4.1.2","depth":3,"next":{"title":"Qemu搭建ARM-vexpress开发环境-3-NFS网络根文件系统","level":"1.4.1.3","depth":3,"path":"qemu/Qemu搭建ARM-vexpress开发环境-3-NFS网络根文件系统.md","ref":"qemu/Qemu搭建ARM-vexpress开发环境-3-NFS网络根文件系统.md","articles":[]},"previous":{"title":"Qemu搭建ARM-vexpress开发环境-1","level":"1.4.1.1","depth":3,"path":"qemu/Qemu搭建ARM-vexpress开发环境-1.md","ref":"qemu/Qemu搭建ARM-vexpress开发环境-1.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["livereload"],"pluginsConfig":{"livereload":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"qemu/Qemu搭建ARM-vexpress开发环境-2-u-boot启动kernel.md","mtime":"2020-09-20T08:26:34.801Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2020-09-20T08:30:58.779Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

